<h1>Editar Tutor</h1>
<div class="well">
    <form #formTutor="ngForm">
        <div class="form-group">
            <label for="nome">Nome:</label>
            <input type="text" class="form-control" id="nome" name="nome" [(ngModel)]="tutor.nomeCompleto" #nome="ngModel"
                required>
            <div *ngIf="nome.errors && (nome.dirty || nome.touched)" class="alert alert-danger">
                <div [hidden]="!nome.errors?.required"> Digite o nome da pessoa. </div>
            </div>
        </div>

        <div class="row">
            <div class="col">
                <label for="email">E-mail:</label>
                <input type="text" class="form-control" id="email" name="email" [(ngModel)]="tutor.email"
                    #email="ngModel">
                <div *ngIf="email.errors && (email.dirty || email.touched)" class="alert alert-danger">
                    <div [hidden]="!email.errors?.required"> Digite o e-mail do tutor</div>
                </div>
            </div>

            <div class="col">
                <label for="profissao">Profissão:</label>
                <input type="text" class="form-control" id="profissao" name="profissao" [(ngModel)]="tutor.profissao"
                    #profissao="ngModel">
                <div *ngIf="profissao.errors && (profissao.dirty || profissao.touched)" class="alert alert-danger">
                    <div [hidden]="!profissao.errors?.required"> Digite a profissão</div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col">
                <label for="cpf">CPF:</label>
                <input type="text" class="form-control" id="cpf" name="cpf" disabled [(ngModel)]="tutor.cpf" #cpf="ngModel">
                <div *ngIf="cpf.errors && (cpf.dirty || cpf.touched)" class="alert alert-danger">
                    <div [hidden]="!cpf.errors?.required"> Digite o cpf</div>
                </div>
            </div>

            <div class="col">
                <label for="telefone">Celular:</label>
                <input type="text" class="form-control" id="telefone" name="telefone" [(ngModel)]="tutor.telefone"
                    #telefone="ngModel">
                <div *ngIf="telefone.errors && (telefone.dirty || telefone.touched)" class="alert alert-danger">
                    <div [hidden]="!telefone.errors?.required"> Digite o Celular</div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="switch">
                <label for="avisos">Receber avisos?</label>
                <input class="cmn-toggle cmn-toggle-round"  type="checkbox" id="avisos" name="receberAvisos" [(ngModel)]="tutor.receberAvisos">
                <label for="avisos"></label>
            </div>

        </div>
        
        <br>

        <div class="input-group mb-3">
            <div class="input-group-append">
                <button class="btn btn-outline-secondary" (click)="bucarCEP($event)" type="button">Buscar</button>
              </div>
            <input type="text" class="form-control" placeholder="CEP" aria-label="Recipient's username" aria-describedby="basic-addon2" id="cep" name="cep" [(ngModel)]="endereco.cep">

          </div>

        <div class="row">
            <div class="col">
                <input type="text" class="form-control" placeholder="Logradouro" id="logradouro" name="logradouro" [(ngModel)]="endereco.logradouro">
            </div>
        </div>

        <br>

        <div class="row">
            <div class="col">
                <input type="text" class="form-control" placeholder="Complemento" id="complemento" name="complemento" [(ngModel)]="endereco.complemento">
            </div>
        <br>

            <div class="col">
                <input type="text" class="form-control" placeholder="Bairro" id="bairro" name="bairro" [(ngModel)]="endereco.bairro">
            </div>
        </div>
        <br>

        <div class="row">
            <div class="col">
                <input type="text" class="form-control" placeholder="Localidade" id="localidade" name="localidade" [(ngModel)]="endereco.localidade">
            </div>
            <br>

            <div class="col">
                <input type="text" class="form-control" placeholder="UF" id="uf" name="uf" [(ngModel)]="endereco.uf">
            </div>
        </div>

        <br>
        <div class="form-group">
            <button style="margin: 1px" type="button" class="btn btn-primary" (click)="abrirModal(template)">Paciente</button>

            <button type="button" class="btn btn-primary" (click)="atualizar()" style="margin: 5px" [disabled]="!formTutor.form.valid">
                <i class="fa fa-save" aria-hidden="true"></i> Atualizar
            </button>
            <a class="btn btn-secondary" style="margin: 1px" [routerLink]="['/tutores']">
                <i class="fa fa-arrow-left" aria-hidden="true"></i> Voltar
            </a>
        </div>
    </form>
</div>

<ng-template #template>
    <div class="modal-header">
      <h4 class="modal-title pull-left">Paciente</h4>
      <button type="button" class="btn-close close pull-right" aria-label="Close" (click)="fecharModal()">
        <span aria-hidden="true" class="visually-hidden">&times;</span>
      </button>
    </div>
    <div class="modal-body">

        <div class="row">
            <div class="switch">
                <label for="statusPaciente">Paciente vivo?</label>
                <input class="cmn-toggle cmn-toggle-round"  type="checkbox" id="statusPaciente" name="statusPaciente" [(ngModel)]="paciente.status">
                <label for="statusPaciente"></label>
            </div>
        </div>
        <br>
        <div class="row">
            <div class="col">
                <input type="text" class="form-control" placeholder="Nome" id="nomePaciente" name="nomePaciente" [(ngModel)]="paciente.nome">
            </div>
        <br>

        <div class="col">
                <input type="text" class="form-control" placeholder="Especie" id="especiePaciente" name="especiePaciente" [(ngModel)]="paciente.especie">
            </div>
        </div>
        <br>
        <div class="row">
            <div class="col">
                <input type="text" class="form-control" placeholder="Data de Nacimento" id="dataNacimentoPaciente" name="dataNacimentoPaciente" [(ngModel)]="paciente.dataNacimento">
            </div>
        <br>

            <div class="col">
                <input type="text" class="form-control" placeholder="Raça" id="racaPaciente" name="racaPaciente" [(ngModel)]="paciente.raca">
            </div>
        </div>
        <br>
        <div class="row">
            <div class="col">
                <input type="text" class="form-control" placeholder="Raca Secundaria" id="racaSecundariaPaciente" name="racaSecundariaPaciente" [(ngModel)]="paciente.racaSecundaria">
            </div>
        <br>

            <div class="col">
                <input type="text" class="form-control" placeholder="Porte" id="portePaciente" name="portePaciente" [(ngModel)]="paciente.porte">
            </div>
        </div>
        <br>
        <div class="row">
            <div class="col">
                <input type="text" class="form-control" placeholder="Alergias" id="alergiasPaciente" name="alergiasPaciente" [(ngModel)]="paciente.alergias">
            </div>
        <br>

            <div class="col">
                <input type="text" class="form-control" placeholder="Agressivo" id="agressivoPaciente" name="agressivoPaciente" [(ngModel)]="paciente.agressivo">
            </div>
        </div>
        <br>
        <div class="row">
            <div class="col">
                <input type="text" class="form-control" placeholder="Sexo" id="sexoPaciente" name="sexoPaciente" [(ngModel)]="paciente.sexo">
            </div>
        <br>

            <div class="col">
                <input type="text" class="form-control" placeholder="Apto a Reprodução" id="aptoAReproducaoPaciente" name="aptoAReproducaoPaciente" [(ngModel)]="paciente.aptoAReproducao">
            </div>
        </div>
        <br>
        <div class="row">
            <div class="col">
                <input type="text" class="form-control" placeholder="Pedigree" id="pedigreePaciente" name="pedigreePaciente" [(ngModel)]="paciente.pedigree">
            </div>
        <br>

            <div class="col">
                <input type="text" class="form-control" placeholder="Microchip" id="microchipPaciente" name="microchipPaciente" [(ngModel)]="paciente.microchip">
            </div>
        </div>

        <br>
        <div class="row">
            <div class="col">
                <input type="text" class="form-control" placeholder="Observacoes" id="observacoesPaciente" name="observacoesPaciente" [(ngModel)]="paciente.observacoes">
            </div>
        </div>
        <br>
        <div class="form-group">
            <button type="button" class="btn btn-primary" (click)="inserirPaciente($event)">
                <i class="fa fa-save" aria-hidden="true"></i> Salvar
            </button>
        </div>
        
    </div>
  </ng-template>

<!-- Listagem de Pacientes desse tutor-->
<hr>
<h3>Meus animaizinhos</h3>
<hr />
<table class="table table-striped table-bordered table-hover">
    <tbody>
        <tr>
            <th>Nome</th>
            <th>Especie</th>
            <th>Sexo</th>
        </tr>
        <tr *ngFor="let paciente of pacientes">
            <th>{{paciente.nome}}</th>
            <th>{{paciente.especie}}</th>
            <th>{{paciente.sexo}}</th>
            <td class="text-center" style="width: 300px">
                <a href="#" title="Editar" alt="Editar" class="btn btn-xs btn-info"
                    [routerLink]="['/pacientes/editar', paciente.recID_Paciente]">
                    <i class="fa fa-edit" aria-hidden="true"></i> Editar
                </a>
            </td>
        </tr>
    </tbody>
</table>
<p *ngIf="pacientes.length==0">Nenhum paciente cadastrado.</p>